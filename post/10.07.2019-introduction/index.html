<!DOCTYPE html>
<html lang="en-Us">
    <head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<title>
				Securing Hardware with Coreboot &middot; Slices of a hacker&#39;s mind
		</title>

		
  		<link rel="stylesheet" href="/css/style.css">
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">
		
		<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
		<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

		
		<link href="" rel="alternate" type="application/rss+xml" title="Slices of a hacker&#39;s mind" />
	</head>

    <body>
        		<nav class="nav">
			<div class="nav-container">
				<a href="/">
					<h2 class="nav-title">Slices of a hacker&#39;s mind</h2>
				</a>
				<ul>
    <li><a href="/contact">About</a></li>
    <li><a href="/">Posts</a></li>
    <li><a href="/flash">Flash Posts</a></li>
    <li><a href="/categories">Categories</a></li>
    <li><a href="/privacy">Privacy</a></li>
</ul>

			</div>
		</nav>

        

<main>
	<div class="post">
		<div class="post-info">
    <span>Written by</span>
        akendo
        <br>
        <span>on&nbsp;</span><time datetime="2019-07-10 19:35:24 &#43;0200 CEST">July 10, 2019</time>
</div>
		<h1 class="post-title">Securing Hardware with Coreboot</h1>
<div class="post-line"></div>

		

		

<h2 id="table-of-contents">Table of Contents</h2>

<ul>
<li><a href="#">Securing Hardware with Coreboot</a>

<ul>
<li><a href="#table-of-contents">Table of Contents</a></li>
</ul></li>
<li><a href="#introduction">Introduction</a>

<ul>
<li><a href="#why-do-we-trust-a-system">Why do we trust a system?</a></li>
<li><a href="#backdoor-capabilities-in-hardware">Backdoor-Capabilities in Hardware</a></li>
</ul></li>
</ul>

<h1 id="introduction">Introduction</h1>

<p>A laptop is sent in for an audit. It was reported that this particular
laptop was exhibiting some &lsquo;odd&rsquo; behavior. &lsquo;Odd behavior?&rsquo; one might
think. Just a user who is doing it wrong. Minutes later, an
<strong>O</strong>perating <strong>S</strong>ystem (OS) with a famous logo has been booted and the
investigation begins.</p>

<p>The misbehavior is that at any given time on a website an advertisement
is displayed. Imagine a blank HTML page with the imprint of &lsquo;Hello
World&rsquo; and right beneath it a width banner for whatever sells best in this
moment. &lsquo;Odd&rsquo;, one might think. The banner cannot be found in the actual
source code. But a solution is at hand: The installation of an
<strong>A</strong>nti-<strong>V</strong>irus (AV) software.</p>

<p>One AV-Scan later, a nasty malware, an abbreviation for <strong>mal</strong>icious
soft<strong>ware</strong>, is found. Software that appends to any given website an
advertisement banner. The AV Software suggests to do what it can do
best; removing the malware. It seems that the oddness has been taken
care of.</p>

<p>The computer is left running for another day, as routine dictates. On
the next day, the weirdness is about to start over: The malware has
returned. Without the Anti-Virus noticing, the malware was re-installed
on the Windows laptop. Another AV-Scan tells the same story. Again, the
AV Software deletes the malware. Was this maybe a malfunction of the AV
Software?</p>

<p>The malware is found again. Again a banner for some dirty websites is
concatenated into the &lsquo;Hello World&rsquo; page of the web browser. This time,
another AV Software is installed. As its predecessor, it unveils the
malware and erases its traces from the surface of the hard disk. Yet
only, to be found once more later. One might change to another AV
product of the many solutions the market offers, in the hope one of them
might deal with it correctly. However, why should anyone trust a
compromised system anyway? The auditor decides to do a fresh
installation of the Windows laptop.</p>

<p>Some time later, the laptop has a new installation of Windows, including
the newest security patches. The odds are now against the malware, one
might think. For another night, the computer keeps running and the
malware seems to be gone. But what is this? The next day, the malware
returns. Did the malware just re-install itself?</p>

<p>A conclusion comes to mind: <em>Has some hardware related component been
infected?</em> Parts of the computer will be replaced, the hard drive, the
<strong>N</strong>etwork <strong>I</strong>nterface <strong>C</strong>ard (NIC) until only the motherboard
remains. Fortunately, the ROM Chip in which the BIOS, the Basic Input
and Output System, lives can be exchanged. The BIOS is responsible to
initialize the hardware. A new ROM Chip was purchased over the vendor.
The same procedure is conducted once more, re-installation of the OS and
another day that passes. This time, no advertisement shows up. For once,
no new malware installation is unveiled. It has been defeated!</p>

<h2 id="why-do-we-trust-a-system">Why do we trust a system?</h2>

<p>In a plot like chapter <a href="#introduction">one (introduction)</a>, we are not confronted
with malware, but with a type of software that is named &lsquo;rootkit&rsquo;, or
&lsquo;bootkit&rsquo;. A rootkit is a piece of software that acts maliciously and
compromises a system in a way that it changes execution flow. Allowing
arbitrary code to be executed and changing the behavior of the affected
system to the authors biding. While the plot from chapter <a href="#introduction">one</a>  was imaginary, one could only imagine how a
researcher has found the &lsquo;Mebromi
rootkit&rsquo;[@Mebromi][@theregisterMebromi] <sup class="footnote-ref" id="fnref:1"><a href="#fn:1">1</a></sup>.</p>

<p>With the rise of computers, they become ubiquitous in our environment.
We entrust them everyday with more and more tasks that are crucial for
our society as a whole. However, with this degree of importance, how
much of the systems we are using can be considered to be trustworthy? In the plot of chapter [[cha:Introduction]], it was an obvious situation.</p>

<p>Over the last 20 years, computer systems have become so complex that no
one can handle their complexity. Software and hardware alike have grown
in this intricacy likewise. While software can be reviewed, hardware
cannot. Many vendors of hardware[@amdflaws][@heiseAMD] also do not allow
reviews. Systems are sold as black boxes and hardware vendors just
implement them to their system. These are many areas in which a rootkit
can nest.</p>

<p>Different researches[@KK_BIOS][@mrb][@Heads][@Thunderstrike] have shown
that attacks on firmware components are quite likely. Some time ago, a
researcher presented an obnoxious type of rootkit named: &lsquo;badBIOS&rsquo;[@Leyden]. A rootkit that is supposed to infect a system using
ultrasonic sound. While many experts[@Grimes] remain doubtful about it,
researchers from the Fraunhofer Institute have shown in their paper: &lsquo;On
Covert Acoustical Mesh Networks In Air&rsquo;[@HG] that using ultrasonic sound
is a valid communications channel. The security researcher Robert Graham
analyzed the composed feature of the &lsquo;badBIOS&rsquo; and concluded[@Graham]
that it is plausible.</p>

<p>With the development of a proof of concept (POC) rootkit
&lsquo;LightEater&rsquo;[@KK_BIOS], Corey Kallenberg and Xeno Kovah demonstrated how
plausible rootkits in BIOS[@KK_BIOS2] are. &lsquo;LightEater&rsquo; allowed the
extracting of GPG keys, even when a secure OS like Tails was running.</p>

<h2 id="backdoor-capabilities-in-hardware">Backdoor-Capabilities in Hardware</h2>

<p>[[figure:backdoor_via_inverter]]{#figure:backdoor_via_inverter
label=&ldquo;figure:backdoor_via_inverter&rdquo;} ![Backdoor via an Inverter[@BRPB
Page 7, Figure 1]]
<img src="pictures/logic_gate_backdoor.png" alt="" /></p>

<p>[Backdoor via an Inverter[@BRPB Page 7, Figure 1]]: images/logic_gate_backdoor.png
    &ldquo;fig:&rdquo; {width=&ldquo;.4\paperwidth&rdquo;}</p>

<p>It is possible that a computer with all security patches still might be
compromised, with changes[@BRPB][@OM] deep inside the hardware, beyond
detection from any software. This might be possible when it is embedded
into the firmware[@BLFBM][@Rutkowska] or in the hardware itself.
Firmware is hardware specific software. The word firmware is composed
out of the words &lsquo;<strong>firm</strong>&rsquo; and &lsquo;soft<strong>ware</strong>&rsquo;. The word firm refers to
a company in this context.</p>

<p>With the NICSSH[@Triulzi page 4], an attack was demonstrated that aims
at functions in modern NICs. This attack allows to execute a minimal SSH
Server within the NIC. This way, an attacker can access the hardware via
the network traffic. He can then snoop all of the network traffic. While
the NIC might not hold enough resources for longer traffic dumps,
another device can be utilized to bypass this obstacle. Hardware, such
as the graphic card, will be used in order to store the network traffic
in the memory of the GPU. The CPU is almost entirely uninvolved.</p>

<p>Apart from potential backdoors, Intel itself does provide backdoor type
capabilities within its shipped hardware. The &lsquo;Intel Anti-Theft
Technology&rsquo;[@Intel] allows to control modern processors remotely, even
when the OS is turned off. It might be disabled, but even a corporation
like Intel is not always capable of securing their products
appropriately.</p>

<p>Once hardware itself becomes compromised, it is almost impossible to detect the compromised component.Figure [[figure:backdoor_via_inverter]] shows a hardware Trojan
altering the behavior of logic gates that are composed out of CMOS. On
the left side of figure [[figure:backdoor_via_inverter]], there is
the supposed inverter and on the right side a compromised one. The
compromised gate will be placed within critical components, components
like a Random Number Generator (RND). This would lead to the result that
the RND produces numbers of predictable manner for an attacker.[@BRPB
Page 10]</p>

<p>Other methods to compromise hardware exist: the Hardware Description
Language (HDL)[@BHN page 42], for example, responsible for the designs
of specific components. Another option could be the implementation of
shadowing components[@WS] during the development process of hardware.</p>

<p>[[figure:cost_security_overview]]{#figure:cost_security_overview
label=&ldquo;figure:cost_security_overview&rdquo;} ![Cost of Security [@Gadsden]]</p>

<p>[Cost of Security [@Gadsden]]: images/optimal-security.png &ldquo;fig:&rdquo;
  {width=&ldquo;.63\paperwidth&rdquo;}</p>

<p>Figure shows a hardware Trojan altering the behavior of logic gates that are composed out of CMOS. On the left side of figure, there is
the supposed inverter and on the right side a compromised one. The
compromised gate will be placed within critical components, components
like a Random Number Generator (RND). This would lead to the result that
the RND produces numbers of predictable manner for an attacker.[\@BRPB
Page 10]</p>

<p>[[cha:Introduction]]: #cha:Introduction {reference-type=&ldquo;ref&rdquo;
  reference=&ldquo;cha:Introduction&rdquo;}
  [[figure:backdoor_via_inverter]]: #figure:backdoor_via_inverter
  {reference-type=&ldquo;ref&rdquo; reference=&ldquo;figure:backdoor_via_inverter&rdquo;}</p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:1"><p>Most security researchers do not disclose the way they found a
rootkit.</p>
 <a class="footnote-return" href="#fnref:1"><sup>[return]</sup></a></li>
</ol>
</div>


		
	</div>

	<div class="pagination">
		<a href="/flash/06.07.2019-linkdrop/" class="left arrow">&#8592;</a>

        <p><a rel="license" href="https://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="pictures/80x15.png" /></a><br />This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</p>


		<a href="#" class="top">Top</a>
	</div>

</main>



        		<footer>
			<span>
			&copy; <time datetime="2019-07-11 12:41:30.25465964 &#43;0200 CEST m=&#43;0.058989169">2019</time> . Made with <a href='https://gohugo.io'>Hugo</a> using the <a href='https://github.com/EmielH/tale-hugo/'>Tale</a> theme.
			</span>
		</footer>

    </body>
</html>
