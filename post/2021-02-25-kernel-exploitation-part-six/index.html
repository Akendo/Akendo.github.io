<!DOCTYPE html>
<html lang="en-Us">
    <head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

        <title>Kernel Exploitation Part Six &middot; Slices of a hacker&#39;s mind</title>

		
  		<link rel="stylesheet" href="/css/style.css">
		<link rel="stylesheet" href="/css/fonts">
		
		<link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico">
		<link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico">
		<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

		
		<link href="" rel="alternate" type="application/rss+xml" title="Slices of a hacker&#39;s mind" />
	</head>

    <body>
        		<nav class="nav">
			<div class="nav-container">
				<a href="/">
					<h2 class="nav-title">Slices of a hacker&#39;s mind</h2>
				</a>
				<ul>
    <li><a href="/contact">About</a></li>
    <li><a href="/flash">Flash Posts</a></li>
    <li><a href="/post">Posts</a></li>
    <li><a href="/search">Search</a></li>
    <li><a href="/privacy">Privacy</a></li>
</ul>

			</div>
		</nav>

        

<main>
	<div class="post">
		<div class="post-info">
    <span>Written by</span>
        akendo
        <span>on&nbsp;</span><time datetime="2021-02-25 12:07:41 &#43;0100 CET">February 25, 2021</time>
        <br>
        <span>3 minutes reading </span>
         <span> posted in 
    
        <a href="https://blog.akendo.eu/categories/security/">Security</a>
	
    
	
    </span>
    <span>
    <br>
    
 
  with tags:
   <a href="https://blog.akendo.eu/tags/kernel/">kernel</a> <a href="https://blog.akendo.eu/tags/100daystooffload/">100daystooffload</a></ul>



</div>

		<h1 class="post-title">Kernel Exploitation Part Six</h1>
<div class="post-line"></div>

		

		<p>This post is the sixth and last part of my notes from the lecture about kernel exploitation of pwn.college[0]. This also concludes the first lecture. Read the previous post first:</p>
<ul>
<li><a href="/post/2021-02-25-kernel-exploitation-part-five/">Here</a> about the fifth part.</li>
<li><a href="/post/2021-02-07-kernel-exploitation-part-four/">Here</a> about the fourth.</li>
<li><a href="post/2021-02-04-kernel-exploitation-part-three/">Here</a> about the third part.</li>
<li><a href="/post/2021-02-02-kernel-exploitation-part-two/">Here</a> about the second part.</li>
<li><a href="/post/2021-02-01-kernel-exploitation-part-one/">Here</a> about first part.</li>
</ul>
<p>In the last post we did leaned about the kernel relationship to the user space. Today we see how the attack are happening in the kernel.</p>
<p><img src="/pictures/Kernel-Introduction8.jpg" alt=""></p>
<p>Before we’re going to get into the attack itself, it is worth to mention that kernel code is just code. Hence, all types of vulnerabilities affecting the code base too. I’m aware of the fact, that the kernel has some mitigation strategy to prevent format string vulnerabilities.</p>
<p>A good example for an exploit was the ping of death. It included several useful aspects. Remotely and was often rather simpler to exploit. However, it was more common back in the 90s.</p>
<p>More modern exploit User space like syscall handles or interfaces of the kernel. This is mostly used to exploit sandboxes.</p>
<p><img src="/pictures/Kernel-Introduction9.jpg" alt=""></p>
<p>Here some note: That’s one problem that docker has. It isolates process  from within the kernel by using namespaces. However, unlike a VM all these names spaces share the same kernel. Leading to the underlying problem that an attacker can exploit syscalls (I think there are around 200 of them). That’s why you should and isolation layer in between. In modern clouds environments we often see that various clients will have all their container within a VM of it its own. But also there are some nice abstraction to have more isolation on the syscall level. gvisor[1] it is called.</p>
<p>Their exploit accesses due resources that is provided due to performance reasons.</p>
<p>Remember in the previous post about the vsyscall mapping? Here is the thing why it was replaced. For once, it had only a limitation of four syscalls, BUT it was a kernel function that was read only where an attack could use some ROP to change the invoking parameters[2]. That’s not a desirable outcome, isn’t it?</p>
<p>What we see is the difficulties of overlapping between kernel and user space boundaries. How hard it is to get it right and make sure that things are not going south. I think the vsyscall is a perfect example. None of the developers did think that it could be exploited that way.</p>
<p>I think that’s why he’s mention this feature, it’s a low-hanging fruit that can be found by some simple googling around.</p>
<p>Besides of this hidden example, an exploit can be executed by a device driver. There are even specified devices that can exploit it. teensy for instance.</p>
<p>There is a battery of broken hardware driver within the kernel bug tracker. Many found by fuzzers like Skycaller. The main problem here is that most maintainer are not reachable anymore or some other problem to get them to fix it. Hence, it is a good attack vector for exploitation.</p>
<p>Once you have established the necessary access level you want to pursue different goals:</p>
<ul>
<li>Persistent</li>
<li>Rootkit and hiding</li>
<li>to gain more access to deeper hardware for instance Androids TrustZone</li>
</ul>
<p>One hit I like to add is to own/pwn the machine, Apple iPhones for instance do not grant root privileges to you. Hence, running an exploit is the act of taking control and ownership.</p>
<p>This concludes the first lecture. I felt like that the last slides provided too much value information, at least for me. Next is to setup the testing environment.</p>
<p>so far,<br>
akendo</p>
<p>[1] <a href="https://gvisor.dev/">https://gvisor.dev/</a> <br>
[2] <a href="https://lwn.net/Articles/446528/">https://lwn.net/Articles/446528/</a></p>


		
	</div>

	<div class="pagination">
		<a href="/post/2021-02-25-kernel-exploitation-part-five/" class="left arrow">&#8592;</a>
		<a href="/post/2021-02-26-fun-search-results/" class="right arrow">&#8594;</a>

		<a href="#" class="top">Top</a>
	</div>

</main>



        		<footer>
			
			<span>
			&copy; <time datetime="2023-05-02 07:01:30.195006534 &#43;0200 CEST m=&#43;0.154891084">2023</time> . Made with <a href='https://gohugo.io'>Hugo</a> using the <a href='https://github.com/EmielH/tale-hugo/'>Tale</a> theme.
			</span>
		</footer>

    </body>
</html>
