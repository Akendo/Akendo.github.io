<!DOCTYPE html>
<html lang="en-Us">
    <head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

        <title>Kernel Exploitation Part Five &middot; Slices of a hacker&#39;s mind</title>

		
  		<link rel="stylesheet" href="/css/style.css">
		<link rel="stylesheet" href="/css/fonts">
		
		<link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico">
		<link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico">
		<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

		
		<link href="" rel="alternate" type="application/rss+xml" title="Slices of a hacker&#39;s mind" />
	</head>

    <body>
        		<nav class="nav">
			<div class="nav-container">
				<a href="/">
					<h2 class="nav-title">Slices of a hacker&#39;s mind</h2>
				</a>
				<ul>
    <li><a href="/contact">About</a></li>
    <li><a href="/flash">Flash Posts</a></li>
    <li><a href="/post">Posts</a></li>
    <li><a href="/search">Search</a></li>
    <li><a href="/privacy">Privacy</a></li>
</ul>

			</div>
		</nav>

        

<main>
	<div class="post">
		<div class="post-info">
    <span>Written by</span>
        akendo
        <span>on&nbsp;</span><time datetime="2021-02-25 10:03:19 &#43;0100 CET">February 25, 2021</time>
        <br>
        <span>2 minutes reading </span>
         <span> posted in 
    
        <a href="https://blog.akendo.eu/categories/security/">Security</a>
	
    
	
    </span>
    <span>
    <br>
    
 
  with tags:
   <a href="https://blog.akendo.eu/tags/kernel/">kernel</a> <a href="https://blog.akendo.eu/tags/100daystooffload/">100daystooffload</a></ul>



</div>

		<h1 class="post-title">Kernel Exploitation Part Five</h1>
<div class="post-line"></div>

		

		<p>This post is the five part of my notes from the lecture about kernel exploitation of pwn.college[0]. Read the previous post first:</p>
<ul>
<li><a href="/post/2021-02-01-kernel-exploitation-part-one/">Here</a> about the first part.</li>
<li><a href="/post/2021-02-02-kernel-exploitation-part-two/">Here</a> about the second part.</li>
<li><a href="post/2021-02-04-kernel-exploitation-part-three/">Here</a> about the third part.</li>
<li><a href="/post/2021-02-07-kernel-exploitation-part-four/">Here</a> about the fourth part.</li>
</ul>
<p>In the last post we did leaned about the kernels&rsquo; effort to switch from one ring down to another one and when it becomes necessary. Today we see how the user space relates to the kernel space.</p>
<h3 id="kernel-userspace-relationship">Kernel-Userspace Relationship</h3>
<p>Like any other program on your computer does the Kernel have its  own address space (dahhh). The different is that the address in memory at a higher address. This is the opposite to User space address.</p>
<p>An artifact of this can be seen when we access the memory map (<code>/proc/self/maps</code>) of a user space program. With the map table exist the vsyscall entry.</p>
<p><img src="/pictures/Kernel-Introduction7.jpg" alt=""></p>
<p>However, it is an out-dated function that existed for optimization reasons. The lecturer does not explain this in detail. But it is worth a small side step[1].</p>
<p>Back in the days some syscalls where executed excessively to get quite little information from the kernel. <code>gettimeofday</code> is a good example for it. At some point this became too much overhead that the kernel developers decided to map it into the user space instead. Doing this mapping had some performance advantages. Yet, it introduces many other limitation and issues. In short it is outdated by today&rsquo;s standard.</p>
<p>The interesting bit is the following: It still exists because application often rely on that fact. In the latest Debian release this was changed and might cause applications to break: They&rsquo;re still assuming that these four mapped syscalls exists there. However, this was done for some security reasons and make a lot of sense.</p>
<p>Back to the kernel space: The Kernel page access from user space via syscalls do not change the virtual address mapping! Thatâ€™s probably the reason, why the kernel address are high up in addressing to allow consisted access to the given application. Moreover, it makes sense considering that there is, I think only a single virtual address for the kernel where everything of the kernel resides in.</p>
<p>so far,<br>
akendo</p>
<p>[0] <a href="https://pwn.college/modules/kernel">https://pwn.college/modules/kernel</a> <br>
[1] <a href="https://stackoverflow.com/questions/19938324/what-are-vdso-and-vsyscall">https://stackoverflow.com/questions/19938324/what-are-vdso-and-vsyscall</a></p>


		
	</div>

	<div class="pagination">
		<a href="/post/2021-02-24-ci-cd/" class="left arrow">&#8592;</a>
		<a href="/post/2021-02-25-kernel-exploitation-part-six/" class="right arrow">&#8594;</a>

		<a href="#" class="top">Top</a>
	</div>

</main>



        		<footer>
			
			<span>
			&copy; <time datetime="2023-04-30 22:28:19.983939624 &#43;0200 CEST m=&#43;0.163079260">2023</time> . Made with <a href='https://gohugo.io'>Hugo</a> using the <a href='https://github.com/EmielH/tale-hugo/'>Tale</a> theme.
			</span>
		</footer>

    </body>
</html>
