<!DOCTYPE html>
<html lang="en-Us">
    <head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

        <title>Kernel Exploitation Part Two &middot; Slices of a hacker&#39;s mind</title>

		
  		<link rel="stylesheet" href="/css/style.css">
		<link rel="stylesheet" href="/css/fonts">
		
		<link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico">
		<link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico">
		<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

		
		<link href="" rel="alternate" type="application/rss+xml" title="Slices of a hacker&#39;s mind" />
	</head>

    <body>
        		<nav class="nav">
			<div class="nav-container">
				<a href="/">
					<h2 class="nav-title">Slices of a hacker&#39;s mind</h2>
				</a>
				<ul>
    <li><a href="/contact">About</a></li>
    <li><a href="/flash">Flash Posts</a></li>
    <li><a href="/post">Posts</a></li>
    <li><a href="/search">Search</a></li>
    <li><a href="/privacy">Privacy</a></li>
</ul>

			</div>
		</nav>

        

<main>
	<div class="post">
		<div class="post-info">
    <span>Written by</span>
        akendo
        <span>on&nbsp;</span><time datetime="2021-02-02 12:59:28 &#43;0100 CET">February 2, 2021</time>
        <br>
        <span>3 minutes reading </span>
         <span> posted in 
    
        <a href="https://blog.akendo.eu/categories/security/">Security</a>
	
    
	
    </span>
    <span>
    <br>
    
 
  with tags:
   <a href="https://blog.akendo.eu/tags/kernel/">kernel</a> <a href="https://blog.akendo.eu/tags/100daystooffload/">100daystooffload</a></ul>



</div>

		<h1 class="post-title">Kernel Exploitation Part Two</h1>
<div class="post-line"></div>

		

		<p>This is the secound part of my notes from the lecture about kernel exploitation of pwn.college[0]. Read <a href="/post/2021-02-01-kernel-exploitation-part-one/">here</a> about first part.</p>
<p><img src="/pictures/Kernel-Introduction3.jpg" alt=""></p>
<p>He is continuing with the typical ring diagram. I love the fact that he talks about other architecture than x86, however, he left out which one. Do these architectures have more rings or different types of architectures for the privilege? Maybe is he thinking of ARM[1] with the fewer level of privileges?</p>
<p>The outer ring is 3. It’s the most restricted one, yet that is sufficient to execute Google Chrome or Counterstrike. Some note on this matter:
I’m not sure if this accurately depicts because both interact with the GPU that requires some higher privileges? hm&hellip;I think about this point to the device driver as an API for such operations. Ah, I know why: The hardware abstraction causes difficulty for games. Game console this to skip this for the sake of performance, I think.</p>
<p>Back to the lecture. Ring 3 is for Userspace mainly. The remaining rings have some rare use cases. For instance, when operating with the <code>in</code> or <code>out</code> instruction. Meaning for a process that requires limited access to hardware, but nothing else instead. Ring 0 is the Supervisor mode. You can do things that might break your hardware.</p>
<p>Fun fact:
Back in the day, when Intel introduced ACPI. The kernel should take care of the power management of physical hardware, like battery and so on. However, most vendors did a poor job with this. So Intel decided to move this feature into an access level of its own that resided within the hardware. We call this the  System Management Mode (SMM)[2] or ring -1. It is there to maintain power management with the BIOS level. With the years, it did grow in its function and is invisible to the operating system.<br>
He does not refer to the existence of such modes yet. Instead, he put the kernel into ring 1 and adds the hypervisor as ring 0. Considering the SSM, a Hypervisor could be introduced between hardware and kernel, making this to the ring -1 and then SSM to ring -2. With the Intel ME, we also have an additional layer onto of that adding up more. That’s most often outside of the kernel and can mostly not influenced by it. But at this stage it just becomes bizarre.</p>
<p><img src="/pictures/Kernel-Introduction4.jpg" alt=""></p>
<p>He talks about the 2000er years when the first VMs came onto x86. Another fun fact: IBM&rsquo;s mainframes had full hardware virtualization a long time before. It was just the time when CPU resources could be shared because there were not that well saturated. Instead, resource separation with isolation arises as a need within the x86 market, leading to the creation of the hypervisor.</p>
<p>I guess he talks about these points for the reason, that some software wasn’t able to handle the translation from bare metal to virtualization correctly. Hence, moving the kernel on level up in a virtual matter for a consistent view for the application while still having the hypervisor doing its duty.</p>
<p>Hypervisors are fun. I should take a look more at them.</p>
<p>so far,<br>
akendo</p>
<p>[0] <a href="https://cse466.pwn.college/">https://cse466.pwn.college/</a> <br>
[1] <a href="https://developer.arm.com/documentation/102412/0100/Privilege-and-Exception-levels">https://developer.arm.com/documentation/102412/0100/Privilege-and-Exception-levels</a> <br>
[2] <a href="https://de.wikipedia.org/wiki/System_Management_Mode">https://de.wikipedia.org/wiki/System_Management_Mode</a></p>


		
	</div>

	<div class="pagination">
		<a href="/post/2021-02-01-kernel-exploitation-part-one/" class="left arrow">&#8592;</a>
		<a href="/flash/03.02.2021-linkdrop/" class="right arrow">&#8594;</a>

		<a href="#" class="top">Top</a>
	</div>

</main>



        		<footer>
			
			<span>
			&copy; <time datetime="2023-05-02 07:01:30.186509694 &#43;0200 CEST m=&#43;0.146394234">2023</time> . Made with <a href='https://gohugo.io'>Hugo</a> using the <a href='https://github.com/EmielH/tale-hugo/'>Tale</a> theme.
			</span>
		</footer>

    </body>
</html>
